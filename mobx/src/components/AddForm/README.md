[На главную](../../../README.md)

# AddForm.js

AddForm.js - это React компонент, который обрабатывает добавление новых элементов в набор данных для голосования.

## Содержание

- [Описание](#Описание)
- [Сторонние библиотеки](#Сторонние-библиотеки)
- [Логика компонента](#Логика-компонента)
- [Пример использования](#Пример-использования)
- [Примеры кода](#Примеры-кода)

## Описание

Этот компонент отрисовывает форму добавления новых вариантов для голосования. Вы можете ввести данные в текстовое поле и нажать кнопку "Добавить на голосование".

## Сторонние библиотеки

- `React`, `useContext` - основная библиотека для создания пользовательских интерфейсов и хук для использлвания контекст;
- `mobx-react-lite` - Обертка для React компонента, "подключающая" стор mobx, следит за обновлениям;
- `handleSubmit` - функция, которая отвечает за отправку данных на сервер и обновление данных в стор;
- `disableError` - вспомогательная функция для отключения ошибок ввода;

## Логика компонента

На основе состояния `isStarted` отображается либо форма ввода, либо компонент `<Start />`.

При сабмите формы, функция `handleSubmit` проверяет значение `inputValue`. Если `inputValue` является пустой строкой, вспомогательная функция `disableError` вызывается для установки состояния ошибки и прерывает выполнение `handleSubmit`. Если `inputValue` содержит данные, запись добавляется в список голосования путем вызова `postItem`.

Стейт `voteStore.addVoteFormError` используется для отображения ошибок ввода, если поле ввода пустое.

## Пример использования

Для использования этого компонента в вашем приложении достаточно просто его импортировать и указать в нужном месте:

```jsx
import {AddForm} from './AddForm/AddForm';

function App() {
  return (
    <div className="App">
      <AddForm />
    </div>
  );
}

export default App;
```

Теперь форма доступна для добавления элементов.

## Примеры кода

### Подключение сторов

```jsx
  const {userStore} = useContext(StoresContext);
```

Достаем сторы из контекста

### Добавление нового элемента

Если вам нужно отправить async запрос и обновить данные в сторе, то можете вызвать `postItem` и затем обновить данные в сторе через action ф-цию `setVotes`

```jsx
    const votes = await postItem(inputValue);

    voteStore.setVotes(votes);
    voteStore.setAddVoteFormValue('');
```


### Обработка значения инпута

В качестве значения input мы используем observable значение из стора

```jsx
  const isStarted = voteStore.isVoteStarted;
```

В качестве ошибки input мы используем observable значение из стора

```jsx
    voteStore.addVoteFormError
```


`inputValue` содержит введенный пользователем текст, а `voteStore.addVoteFormError` хранит сообщение об ошибке, если таковая имеется.

### Элементы формы и обработка событий

Далее в компоненте присутствуют элементы формы, такие как инпут и кнопка. Они обрабатывают события ввода пользователя и сабмит формы соответственно:

```jsx
<input
    className={`input ${voteStore.addVoteFormError}`}
    type="text"
    value={inputValue}
    onChange={({target}) => voteStore.setAddVoteFormValue(target.value.trim())}
/>

<button className="button" type="submit">
    Добавить на голосование
</button>
```


Если возникнут проблемы или вопросы по использованию этого компонента, не стесняйтесь обращаться в поддержку.

## Обратите внимание

Все API-запросы в этом компоненте направлены на `http://localhost:3001/api/**`. Если ваш сервер работает на другом домене или порту, вам будет необходимо обновить эту настройку.
